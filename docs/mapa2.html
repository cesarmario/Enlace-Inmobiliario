<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
    integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ=="
    crossorigin=""/>
    <title>Document</title>
</head>
<body>
</div>
<div class="form-group col-md-1">
    <input type="hidden" class="form-control"
        value="<?php print($data->DFC_TVI);?>/<?php print  ($data->DFC_NVI)  ;?> <?php print  ($data->DFC_NVIA_I)  ;?>,<?php print  ($data->DFC_CDP)  ;?>, <?php print  ($data->DFC_NLO)  ;?> "
        id="search">
</div>
<hr>
<center>
    <div class="alert alert-info" role="alert">
        Para mostrar la ubicació real del pacient si us plau premi el botón <a href="#" class="alert-link"> MOSTRAR
            DIRECCIÓN EN EL MAPA</a>.
    </div>
    <div class="form-group col-md-1">
        <input type="button" class="btn btn-danger" value="MOSTRAR DIRECCIÓN EN EL MAPA" onClick="mapa.getCoords()">
    </div>
</center>

<div id="mapa" style="width:100%;height:400px;"> </div>
<div>
    <p id="coordenadas"></p>
</div>

<body onload="mapa.initMap()">
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=miapikey&callback=myMap"></script>

    <script>
        mapa = {
            map: false,
            marker: false,

            initMap: function () {

                // Creamos un objeto mapa y especificamos el elemento DOM donde se va a mostrar.

                mapa.map = new google.maps.Map(document.getElementById('mapa'), {
                    center: {
                        lat: 41.376284,
                        lng: 2.160069
                    },
                    scrollwheel: false,
                    zoom: 17,
                    zoomControl: true,
                    rotateControl: true,
                    mapTypeControl: true,
                    streetViewControl: true,
                });

                // Creamos el marcador
                mapa.marker = new google.maps.Marker({
                    position: {
                        lat: 41.376284,
                        lng: 2.160069
                    },
                    draggable: true
                });

                // Le asignamos el mapa a los marcadores.
                mapa.marker.setMap(mapa.map);

            },

            // función que se ejecuta al pulsar el botón buscar dirección
            getCoords: function () {
                // Creamos el objeto geodecoder
                var geocoder = new google.maps.Geocoder();

                address = document.getElementById('search').value;
                if (address != '') {
                    // Llamamos a la función geodecode pasandole la dirección que hemos introducido en la caja de texto.
                    geocoder.geocode({
                        'address': address
                    }, function (results, status) {
                        if (status == 'OK') {
                            // Mostramos las coordenadas obtenidas en el p con id coordenadas
                            document.getElementById("coordenadas").innerHTML = 'Coordenadas:   ' +
                                results[0].geometry.location.lat() + ', ' + results[0].geometry.location
                                .lng();
                            // Posicionamos el marcador en las coordenadas obtenidas
                            mapa.marker.setPosition(results[0].geometry.location);
                            // Centramos el mapa en las coordenadas obtenidas
                            mapa.map.setCenter(mapa.marker.getPosition());
                            agendaForm.showMapaEventForm();
                        }
                    });
                }
            }
        }
    </script>
</body>
</html>